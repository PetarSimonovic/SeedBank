{"ast":null,"code":"import { addBalloon } from './'; // This calculates achievements based on the number of plants in players' garden\n// Every five plants either unlocks a new plant or adds more existing seeds\n// code below works out whether the player can unlock\n// it also adds a balloon to the DB to addive the next day\n// This needs refactoring to for separation of concerns/SRP/DRY\n\nexport default function calculateAchievement(seeds, id, plantCount) {\n  let duplicate = true;\n  let newSeed = {};\n\n  if (seeds.length === seedBank.length) {\n    let bonusSeed = sample(seeds);\n    addBalloon(id, bonusSeed.type, 3, `${plantCount} plants! Bonus ${seed.type} seeds!`); //userId, type, quantity = 0, message, sender = \"SeedBank\")\n\n    return seeds; // newSeed = sample(seedBank)\n    // console.log(\"FULL BANK\")\n    // unlock = false\n  } else {\n    while (duplicate) {\n      newSeed = sample(seedBank);\n      duplicate = checkDuplicate(newSeed, seeds);\n    }\n  }\n\n  return updateSeeds(seeds, newSeed);\n}\n\nfunction sample(array) {\n  return array[Math.floor(Math.random() * array.length)];\n}\n\nfunction checkDuplicate(newSeed, seeds) {\n  for (let index = 0; index < seeds.length; index++) {\n    const seed = seeds[index];\n\n    if (seed.type === newSeed.type) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction updateSeeds(seeds, newSeed) {\n  const updatedSeeds = [];\n\n  for (let index = 0; index < seeds.length; index++) {\n    const seed = seeds[index];\n\n    if (seed.type === newSeed.type) {\n      seed.quantity += newSeed.quantity;\n    }\n\n    updatedSeeds.push(seed);\n  }\n\n  if (unlock) {\n    updatedSeeds.push(newSeed);\n  }\n\n  return updatedSeeds;\n}\n\nconst seedBank = [{\n  type: \"generic_plant\",\n  quantity: 3\n}, {\n  type: \"tulip\",\n  quantity: 3\n}, {\n  type: \"sunflower\",\n  quantity: 3\n}, {\n  type: \"crocus\",\n  quantity: 3\n}, {\n  type: \"snowdrop\",\n  quantity: 3\n}, {\n  type: \"rose\",\n  quantity: 3\n}, {\n  type: \"venusFlyTrap\",\n  quantity: 3\n}];","map":{"version":3,"sources":["/Users/petarsimonovic/Library/Mobile Documents/com~apple~CloudDocs/Pete/Coding/Projects/SeedBankServer/seedbank/client/src/functions/CalculateAchievement.js"],"names":["addBalloon","calculateAchievement","seeds","id","plantCount","duplicate","newSeed","length","seedBank","bonusSeed","sample","type","seed","checkDuplicate","updateSeeds","array","Math","floor","random","index","updatedSeeds","quantity","push","unlock"],"mappings":"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","sourcesContent":["import { addBalloon } from './'\n\n// This calculates achievements based on the number of plants in players' garden\n// Every five plants either unlocks a new plant or adds more existing seeds\n// code below works out whether the player can unlock\n// it also adds a balloon to the DB to addive the next day\n// This needs refactoring to for separation of concerns/SRP/DRY\n\nexport default function calculateAchievement(seeds, id, plantCount) {\n  let duplicate = true\n  let newSeed = {}\n  if (seeds.length === seedBank.length) {\n    let bonusSeed = sample(seeds)\n    addBalloon(id, bonusSeed.type, 3, `${plantCount} plants! Bonus ${seed.type} seeds!`  ) //userId, type, quantity = 0, message, sender = \"SeedBank\")\n    return seeds\n    // newSeed = sample(seedBank)\n    // console.log(\"FULL BANK\")\n    // unlock = false\n  } else {\n  while (duplicate) {\n    newSeed = sample(seedBank)\n    duplicate = checkDuplicate(newSeed, seeds)\n  }\n}\n  return updateSeeds(seeds, newSeed)\n}\n\n\nfunction sample(array) {\n  return array[Math.floor(Math.random() * array.length)];\n}\n\nfunction checkDuplicate(newSeed, seeds) {\n  for (let index = 0; index < seeds.length; index++) {\n    const seed = seeds[index]\n    if (seed.type === newSeed.type) {\n      return true\n    }\n  }\n  return false\n\n}\n\nfunction updateSeeds(seeds, newSeed) {\n  const updatedSeeds = []\n  for (let index = 0; index < seeds.length; index++) {\n    const seed = seeds[index]\n    if (seed.type === newSeed.type) {\n      seed.quantity += newSeed.quantity\n    }\n    updatedSeeds.push(seed)\n  }\n  if (unlock) { updatedSeeds.push(newSeed) }\n  return updatedSeeds\n}\n\nconst seedBank = [\n  {type: \"generic_plant\", quantity: 3},\n  {type: \"tulip\", quantity: 3},\n  {type: \"sunflower\", quantity: 3},\n  {type: \"crocus\", quantity: 3},\n  {type: \"snowdrop\", quantity: 3},\n  {type: \"rose\", quantity: 3},\n  {type: \"venusFlyTrap\", quantity: 3}\n]\n"]},"metadata":{},"sourceType":"module"}